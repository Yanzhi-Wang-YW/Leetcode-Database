```md
1412. Find the Quiet Students in All Exams  
Table: Student

+---------------------+---------+
| Column Name         | Type    |
+---------------------+---------+
| student_id          | int     |
| student_name        | varchar |
+---------------------+---------+
student_id is the primary key (column with unique values) for this table.
student_name is the name of the student.
 

Table: Exam

+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| exam_id       | int     |
| student_id    | int     |
| score         | int     |
+---------------+---------+
(exam_id, student_id) is the primary key (combination of columns with unique values) for this table.
Each row of this table indicates that the student with student_id had a score points in the exam with id exam_id.
 

A quiet student is the one who took at least one exam and did not score the highest or the lowest score.

Write a solution to report the students (student_id, student_name) being quiet in all exams. Do not return the student who has never taken any exam.

Return the result table ordered by student_id.

The result format is in the following example.

 

Example 1:

Input: 
Student table:
+-------------+---------------+
| student_id  | student_name  |
+-------------+---------------+
| 1           | Daniel        |
| 2           | Jade          |
| 3           | Stella        |
| 4           | Jonathan      |
| 5           | Will          |
+-------------+---------------+
Exam table:
+------------+--------------+-----------+
| exam_id    | student_id   | score     |
+------------+--------------+-----------+
| 10         |     1        |    70     |
| 10         |     2        |    80     |
| 10         |     3        |    90     |
| 20         |     1        |    80     |
| 30         |     1        |    70     |
| 30         |     3        |    80     |
| 30         |     4        |    90     |
| 40         |     1        |    60     |
| 40         |     2        |    70     |
| 40         |     4        |    80     |
+------------+--------------+-----------+
Output: 
+-------------+---------------+
| student_id  | student_name  |
+-------------+---------------+
| 2           | Jade          |
+-------------+---------------+
Explanation: 
For exam 1: Student 1 and 3 hold the lowest and high scores respectively.
For exam 2: Student 1 hold both highest and lowest score.
For exam 3 and 4: Student 1 and 4 hold the lowest and high scores respectively.
Student 2 and 5 have never got the highest or lowest in any of the exams.
Since student 5 is not taking any exam, he is excluded from the result.
So, we only return the information of Student 2
```

```py
import pandas as pd

def find_quiet_students(student: pd.DataFrame, exam: pd.DataFrame) -> pd.DataFrame: 
    student_take_exam = exam.copy() 
    student_take_exam = student_take_exam[['student_id']] 
    student_take_exam = student_take_exam.drop_duplicates(subset=['student_id']) 
    exam['min_score'] = exam.groupby('exam_id')['score'].transform('min')  
    exam['max_score'] = exam.groupby('exam_id')['score'].transform('max') 
    exam = exam.loc[(exam['min_score'] == exam['score']) | (exam['max_score'] == exam['score'])] 
    exam = exam[['student_id']] 
    exam = exam.drop_duplicates(subset=['student_id']) 
    output = student.merge(exam, how='left', on='student_id', indicator=True)
    output = output.loc[output['_merge'] == 'left_only'] 
    output = output.merge(student_take_exam, how='inner', on='student_id') 
    output = output[['student_id', 'student_name']]      
    return output 
```

 Here is the step-by-step table flowchart with the corresponding Python code for the `find_quiet_students` function.

### **Step 1: Load Input Data**
Two tables are loaded into memory: `Student` and `Exam`.

**Python Code:**
```python
# Assuming student and exam DataFrames are already loaded as per the function input
# student = ...
# exam = ...
```

**Table Outputs:**
**`Student`**
| student_id | student_name |
| :--- | :--- |
| 1 | Daniel |
| 2 | Jade |
| 3 | Stella |
| 4 | Jonathan |
| 5 | Will |

**`Exam`**
| exam_id | student_id | score |
| :--- | :--- | :--- |
| 10 | 1 | 70 |
| 10 | 2 | 80 |
| 10 | 3 | 90 |
| 20 | 1 | 80 |
| 30 | 1 | 70 |
| 30 | 3 | 80 |
| 30 | 4 | 90 |
| 40 | 1 | 60 |
| 40 | 2 | 70 |
| 40 | 4 | 80 |

---

### **Step 2: Identify Students Who Took Exams**
A distinct list of students who have at least one exam record is created.

**Python Code:**
```python
student_take_exam = exam[['student_id']].drop_duplicates(subset=['student_id'])
```

**Table Output (`student_take_exam`):**
| student_id |
| :--- |
| 1 |
| 2 |
| 3 |
| 4 |

---

### **Step 3: Identify Min and Max Scores per Exam**
For each exam, the minimum and maximum scores are calculated and added as new columns to the `Exam` dataframe.

**Python Code:**
```python
exam['min_score'] = exam.groupby('exam_id')['score'].transform('min')
exam['max_score'] = exam.groupby('exam_id')['score'].transform('max')
```

**Table Output (`exam`):**
*(Highlighted values indicate min/max for each exam)*
| exam_id | student_id | score | **min_score** | **max_score** |
| :--- | :--- | :--- | :--- | :--- |
| 10 | 1 | 70 | 70 | 90 |
| 10 | 2 | 80 | 70 | 90 |
| 10 | 3 | 90 | 70 | 90 |
| 20 | 1 | 80 | 80 | 80 |
| 30 | 1 | 70 | 70 | 90 |
| 30 | 3 | 80 | 70 | 90 |
| 30 | 4 | 90 | 70 | 90 |
| 40 | 1 | 60 | 60 | 80 |
| 40 | 2 | 70 | 60 | 80 |
| 40 | 4 | 80 | 60 | 80 |

---

### **Step 4: Filter "Noisy" Students**
The dataframe is filtered to keep only students who achieved either the minimum or maximum score in any of their exams. These are the "noisy" students.

**Python Code:**
```python
exam = exam.loc[(exam['min_score'] == exam['score']) | (exam['max_score'] == exam['score'])]
exam = exam[['student_id']].drop_duplicates(subset=['student_id'])
```

**Table Output (`exam`):**
| student_id |
| :--- |
| 1 |
| 3 |
| 4 |

---

### **Step 5: Identify Quiet Students**
A Left Join is performed between the `Student` table and the `Noisy Students` list. The `_merge` indicator is used to find students who exist in `Student` but **not** in the `Noisy` list (`left_only`).

**Python Code:**
```python
output = student.merge(exam, how='left', on='student_id', indicator=True)
output = output.loc[output['_merge'] == 'left_only']
```

**Table Output (`output`):**
*(Only Will has no matching entry in the noisy list)*
| student_id | student_name | _merge |
| :--- | :--- | :--- |
| 2 | Jade | left_only |
| 5 | Will | left_only |

---

### **Step 6: Final Verification**
The function defines "quiet students" as those who **have** taken an exam but were **not** noisy. The result from Step 5 is joined with the list of students who took exams (`student_take_exam`) to ensure validity.

**Python Code:**
```python
output = output.merge(student_take_exam, how='inner', on='student_id')
```

**Table Output (`output`):**
*(Student 5 "Will" exists in both tables, so he is kept. If the result were a student who never took an exam, they would be dropped here.)*
| student_id | student_name | _merge |
| :--- | :--- | :--- |
| 2 | Jade | left_only |  

---

### **Step 7: Select Final Output**
The specific columns `student_id` and `student_name` are selected.

**Python Code:**
```python
output = output[['student_id', 'student_name']]
```

**Final Table Output:**
| student_id | student_name |
| :--- | :--- |
| 2 | Jade |   
