```md
1412. Find the Quiet Students in All Exams  
Table: Student

+---------------------+---------+
| Column Name         | Type    |
+---------------------+---------+
| student_id          | int     |
| student_name        | varchar |
+---------------------+---------+
student_id is the primary key (column with unique values) for this table.
student_name is the name of the student.
 

Table: Exam

+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| exam_id       | int     |
| student_id    | int     |
| score         | int     |
+---------------+---------+
(exam_id, student_id) is the primary key (combination of columns with unique values) for this table.
Each row of this table indicates that the student with student_id had a score points in the exam with id exam_id.
 

A quiet student is the one who took at least one exam and did not score the highest or the lowest score.

Write a solution to report the students (student_id, student_name) being quiet in all exams. Do not return the student who has never taken any exam.

Return the result table ordered by student_id.

The result format is in the following example.

 

Example 1:

Input: 
Student table:
+-------------+---------------+
| student_id  | student_name  |
+-------------+---------------+
| 1           | Daniel        |
| 2           | Jade          |
| 3           | Stella        |
| 4           | Jonathan      |
| 5           | Will          |
+-------------+---------------+
Exam table:
+------------+--------------+-----------+
| exam_id    | student_id   | score     |
+------------+--------------+-----------+
| 10         |     1        |    70     |
| 10         |     2        |    80     |
| 10         |     3        |    90     |
| 20         |     1        |    80     |
| 30         |     1        |    70     |
| 30         |     3        |    80     |
| 30         |     4        |    90     |
| 40         |     1        |    60     |
| 40         |     2        |    70     |
| 40         |     4        |    80     |
+------------+--------------+-----------+
Output: 
+-------------+---------------+
| student_id  | student_name  |
+-------------+---------------+
| 2           | Jade          |
+-------------+---------------+
Explanation: 
For exam 1: Student 1 and 3 hold the lowest and high scores respectively.
For exam 2: Student 1 hold both highest and lowest score.
For exam 3 and 4: Student 1 and 4 hold the lowest and high scores respectively.
Student 2 and 5 have never got the highest or lowest in any of the exams.
Since student 5 is not taking any exam, he is excluded from the result.
So, we only return the information of Student 2
```

```py
import pandas as pd

def find_quiet_students(student: pd.DataFrame, exam: pd.DataFrame) -> pd.DataFrame: 
    student_take_exam = exam.copy() 
    student_take_exam = student_take_exam[['student_id']] 
    student_take_exam = student_take_exam.drop_duplicates(subset=['student_id']) 
    exam['min_score'] = exam.groupby('exam_id')['score'].transform('min')  
    exam['max_score'] = exam.groupby('exam_id')['score'].transform('max') 
    exam = exam.loc[(exam['min_score'] == exam['score']) | (exam['max_score'] == exam['score'])] 
    exam = exam[['student_id']] 
    exam = exam.drop_duplicates(subset=['student_id']) 
    output = student.merge(exam, how='left', on='student_id', indicator=True)
    output = output.loc[output['_merge'] == 'left_only'] 
    output = output.merge(student_take_exam, how='inner', on='student_id') 
    output = output[['student_id', 'student_name']]      
    return output 
```

 Here is the step-by-step table flowchart with the corresponding Python code for the `find_quiet_students` function.

### **Step 1: Load Input Data**
Two tables are loaded into memory: `Student` and `Exam`.

**Python Code:**
```python
# Assuming student and exam DataFrames are already loaded as per the function input
# student = ...
# exam = ...
```

**Table Outputs:**
**`Student`**
| student_id | student_name |
| :--- | :--- |
| 1 | Daniel |
| 2 | Jade |
| 3 | Stella |
| 4 | Jonathan |
| 5 | Will |

**`Exam`**
| exam_id | student_id | score |
| :--- | :--- | :--- |
| 10 | 1 | 70 |
| 10 | 2 | 80 |
| 10 | 3 | 90 |
| 20 | 1 | 80 |
| 30 | 1 | 70 |
| 30 | 3 | 80 |
| 30 | 4 | 90 |
| 40 | 1 | 60 |
| 40 | 2 | 70 |
| 40 | 4 | 80 |

---

### **Step 2: Identify Students Who Took Exams**
A distinct list of students who have at least one exam record is created.

**Python Code:**
```python
student_take_exam = exam[['student_id']].drop_duplicates(subset=['student_id'])
```

**Table Output (`student_take_exam`):**
| student_id |
| :--- |
| 1 |
| 2 |
| 3 |
| 4 |

---

### **Step 3: Identify Min and Max Scores per Exam**
For each exam, the minimum and maximum scores are calculated and added as new columns to the `Exam` dataframe.

**Python Code:**
```python
exam['min_score'] = exam.groupby('exam_id')['score'].transform('min')
exam['max_score'] = exam.groupby('exam_id')['score'].transform('max')
```

**Table Output (`exam`):**
*(Highlighted values indicate min/max for each exam)*
| exam_id | student_id | score | **min_score** | **max_score** |
| :--- | :--- | :--- | :--- | :--- |
| 10 | 1 | 70 | 70 | 90 |
| 10 | 2 | 80 | 70 | 90 |
| 10 | 3 | 90 | 70 | 90 |
| 20 | 1 | 80 | 80 | 80 |
| 30 | 1 | 70 | 70 | 90 |
| 30 | 3 | 80 | 70 | 90 |
| 30 | 4 | 90 | 70 | 90 |
| 40 | 1 | 60 | 60 | 80 |
| 40 | 2 | 70 | 60 | 80 |
| 40 | 4 | 80 | 60 | 80 |

---

### **Step 4: Filter "Noisy" Students**
The dataframe is filtered to keep only students who achieved either the minimum or maximum score in any of their exams. These are the "noisy" students.

**Python Code:**
```python
exam = exam.loc[(exam['min_score'] == exam['score']) | (exam['max_score'] == exam['score'])]
exam = exam[['student_id']].drop_duplicates(subset=['student_id'])
```

**Table Output (`exam`):**
| student_id |
| :--- |
| 1 |
| 3 |
| 4 |

---

### **Step 5: Identify Quiet Students**
A Left Join is performed between the `Student` table and the `Noisy Students` list. The `_merge` indicator is used to find students who exist in `Student` but **not** in the `Noisy` list (`left_only`).

**Python Code:**
```python
output = student.merge(exam, how='left', on='student_id', indicator=True)
output = output.loc[output['_merge'] == 'left_only']
```

**Table Output (`output`):**
*(Only Will has no matching entry in the noisy list)*
| student_id | student_name | _merge |
| :--- | :--- | :--- |
| 2 | Jade | left_only |
| 5 | Will | left_only |

---

### **Step 6: Final Verification**
The function defines "quiet students" as those who **have** taken an exam but were **not** noisy. The result from Step 5 is joined with the list of students who took exams (`student_take_exam`) to ensure validity.

**Python Code:**
```python
output = output.merge(student_take_exam, how='inner', on='student_id')
```

**Table Output (`output`):**
*(Student 5 "Will" exists in both tables, so he is kept. If the result were a student who never took an exam, they would be dropped here.)*
| student_id | student_name | _merge |
| :--- | :--- | :--- |
| 2 | Jade | left_only |  

---

### **Step 7: Select Final Output**
The specific columns `student_id` and `student_name` are selected.

**Python Code:**
```python
output = output[['student_id', 'student_name']]
```

**Final Table Output:**
| student_id | student_name |
| :--- | :--- |
| 2 | Jade |   

Here is the step-by-step Microsoft Fabric Dataflow Gen2 instructions 
![alt text](/FabricScreenshot/1412_overview.png) 
### Min and Max per Exam - Noisy Student 
### Step 1: Load Data 
#### Exam table 
| exam_id | student_id | score |
|:---------|:------------|:-------|
| 10      | 1          | 70    |
| 10      | 2          | 80    |
| 10      | 3          | 90    |
| 20      | 1          | 80    |
| 30      | 1          | 70    |
| 30      | 3          | 80    |
| 30      | 4          | 90    |
| 40      | 1          | 60    |
| 40      | 2          | 70    |
| 40      | 4          | 80    | 

### Step 2: Changed column type
Convert `exam_id`, `student_id`, `score` to Whole Number (Int64).

Configuration
- Select `exam_id` → Data type → Whole number
- Select `student_id` → Data type → Whole number
- Select `score` → Data type → Whole number

Table output

|   exam_id |   student_id |   score |
|----------:|-------------:|--------:|
|        10 |            1 |      70 |
|        10 |            2 |      80 |
|        10 |            3 |      90 |
|        20 |            1 |      80 |
|        30 |            1 |      70 |
|        30 |            3 |      80 |
|        30 |            4 |      90 |
|        40 |            1 |      60 |
|        40 |            2 |      70 |
|        40 |            4 |      80 |

### Step 3: Removed duplicates (student_id)
This keeps only the first occurrence of each `student_id` in the current row order.

Configuration
- Click `student_id` column header
- Home (or Transform) → Remove Rows → Remove Duplicates

Table output

|   exam_id |   student_id |   score |
|----------:|-------------:|--------:|
|        10 |            1 |      70 |
|        10 |            2 |      80 |
|        10 |            3 |      90 |
|        30 |            4 |      90 |

### Step 4: Removed other columns (final)
Keep only `student_id`.

Configuration
- Select column `student_id`
- Home → Manage Columns → Remove Other Columns (or choose columns and keep `student_id`)

Final output

|   student_id |
|-------------:|
|            1 |
|            2 |
|            3 |
|            4 | 

### Min and Max per Exam - Noisy Student 
### Step 1: Load Data 
#### Exam table 
| exam_id | student_id | score |
|:---------|:------------|:-------|
| 10      | 1          | 70    |
| 10      | 2          | 80    |
| 10      | 3          | 90    |
| 20      | 1          | 80    |
| 30      | 1          | 70    |
| 30      | 3          | 80    |
| 30      | 4          | 90    |
| 40      | 1          | 60    |
| 40      | 2          | 70    |
| 40      | 4          | 80    | 

### Step 2: Change column types
Make sure exam_id, student_id, and score are Whole Number (Int64) 
#### Configuration
* Select exam_id → Data type → Whole number.
* Select student_id → Data type → Whole number.
* Select score → Data type → Whole number. 

| exam_id | student_id | score |
|:---------|:------------|:-------|
| 10      | 1          | 70    |
| 10      | 2          | 80    |
| 10      | 3          | 90    |
| 20      | 1          | 80    |
| 30      | 1          | 70    |
| 30      | 3          | 80    |
| 30      | 4          | 90    |
| 40      | 1          | 60    |
| 40      | 2          | 70    |
| 40      | 4          | 80    |

### Step 3: Group by exam_id (get min/max)
Group the table by `exam_id` and compute the min and max score for each exam, while also keeping the “all rows” table so you can expand back to the original rows. 

#### Configuration
- Transform → Group By. 
- Choose **Advanced**. 
- Group by: `exam_id`. 
- Aggregations:
- `All_Data` → Operation: **All Rows**. 
- `min_score` → Operation: **Min** on column `score` (or use `List.Min([score])`). 
- `max_score` → Operation: **Max** on column `score` (or use `List.Max([score])`). 

| exam_id | min_score | max_score |
|:---------|:-----------|:-----------|
| 10      | 70        | 90        |
| 20      | 80        | 80        |
| 30      | 70        | 90        |
| 40      | 60        | 80        | 

### Step 4: Expand back to student rows
Expand `All_Data` to bring back `student_id` and `score` next to the `min_score` and `max_score` columns. 

#### Configuration
- Click Expand (two arrows) on `All_Data`. 
- Select `student_id`, `score`. 
- Uncheck “Use original column name as prefix”. 

| exam_id | student_id | score | min_score | max_score |
|:---------|:------------|:-------|:-----------|:-----------|
| 10      | 1          | 70    | 70        | 90        |
| 10      | 2          | 80    | 70        | 90        |
| 10      | 3          | 90    | 70        | 90        |
| 20      | 1          | 80    | 80        | 80        |
| 30      | 1          | 70    | 70        | 90        |
| 30      | 3          | 80    | 70        | 90        |
| 30      | 4          | 90    | 70        | 90        |
| 40      | 1          | 60    | 60        | 80        |
| 40      | 2          | 70    | 60        | 80        |
| 40      | 4          | 80    | 60        | 80        |

### Step 5: Filter to min/max scorers per exam
Keep only the rows where a student’s score equals the `min_score` or `max_score` for that exam. Filter rows with this logic: `[score] = [min_score] OR [score] = [max_score]`. 

#### Configuration 
- Click `score` column dropdown menu > Number filters > Equals...
- Choose **Advanced**
- Keep rows where:
- `score` equals: random value
- `and`
- `score` equals: random value  
- Click **OK**
- Look at the **Formula Bar**
- Delete the `Table.SelectRows(#"Expanded All_Data", each [min_score] = 10 or [#"#(tab)max_score"] = 10)` 
- Replace it with `Table.SelectRows(#"Expanded All_Data", each [min_score] = [score] or [#"#(tab)max_score"] = [score])`  

| exam_id | student_id | score | min_score | max_score |
|---------|------------|-------|-----------|-----------|
| 10      | 1          | 70    | 70        | 90        |
| 10      | 3          | 90    | 70        | 90        |
| 20      | 1          | 80    | 80        | 80        |
| 30      | 1          | 70    | 70        | 90        |
| 30      | 4          | 90    | 70        | 90        |
| 40      | 1          | 60    | 60        | 80        |
| 40      | 4          | 80    | 60        | 80        |

### Step 6: Remove duplicates by student_id
After filtering, a student may appear multiple times across different exams; keep each `student_id` only once. 

#### Configuration
- Select `student_id` column. 
- Home → Remove Rows → Remove Duplicates (or Transform → Distinct). 

| exam_id | student_id | score | min_score | max_score |
|:---------|:------------|:-------|:-----------|:-----------|
| 10      | 1          | 70    | 70        | 90        |
| 10      | 3          | 90    | 70        | 90        |
| 30      | 4          | 90    | 70        | 90        | 

### Step 7: Keep only student_id (final output)
Return only the `student_id` column. 

#### Configuration
- Select columns → keep only `student_id` 

| student_id |
|:------------| 
| 1          |
| 3          |
| 4          |  

### Quiet Student 
This query does a **Left Anti** join to keep students from `"Student Take Exam"` that do **not** appear in `"Min and Max per Exam - Noisy Student"`, then keeps only `student_id` (same “merge + cleanup” pattern as your Fabric notes). 

## Step 0: Inputs (what you must have)
You need two queries loaded in Power Query: `"Student Take Exam"` and `"Min and Max per Exam - Noisy Student"`, and both must contain a `student_id` column. 

### Step 1: Merge queries (Left Anti)
Keep rows from **Student Take Exam** where `student_id` is *not found* in the noisy-student list. 

### Configuration
- Home → **Merge Queries** (or **Merge Queries as New**). 
- Top table: `Student Take Exam`. 
- Bottom table: `Min and Max per Exam - Noisy Student`. 
- Click `student_id` in both previews as the matching key. 
- Join kind: **Left Anti (rows only in first)**. 

### Table output (example shape)
After the merge, Power Query returns the rows from the first table only; you will usually still see the original columns from `"Student Take Exam"` (and it may also show a nested column name from the second query, depending on UX/version). 

Example preview if `"Student Take Exam"` was your original exam table:

| student_id | Min and Max per Exam - Noisy Student |
|------------:|--------------------------------------:|
| 2          | [Table]                              |

(Those are the rows for `student_id = 2`, assuming `2` is not in the noisy list.)

### Step 2: Keep only student_id (Removed other columns)
Keep just the list of student ids that are “not noisy”. 

### Configuration
- Select column `student_id`. 
- Home → Manage Columns → **Remove Other Columns**. 

### Table output (example)
| student_id |
|---:|
| 2 |
| 2 | 

### Output 
This Power Query step does an **Inner** join to keep only `student_id` values that exist in both `"Quiet Student"` and `Student`, then expands the nested `Student` table to bring in `student_name`. 

### Step 1: Merge queries (Inner join)
**Inner** join returns only matching rows, so any `student_id` not found in `Student` will be dropped. 

### Configuration (Power Query Online / Dataflow Gen2)
- Home → **Merge Queries** (or **Merge Queries as New**). 
- Top table: `Quiet Student`. 
- Bottom table: `Student`. 
- Select `student_id` in both tables as the join key. 
- Join kind: **Inner (only matching rows)**. 

| student_id | Student |
|------------:|---------:| 
| 2          | [Table] | 

### Step 2: Expand Student (bring student_name)
### Configuration
- Click the **expand** icon on the `Student` column. 
- Select only `student_name`. 
- Uncheck “Use original column name as prefix”. 

| student_id | student_name |
|------------:|--------------:|
| 2          | Jade         | 



















