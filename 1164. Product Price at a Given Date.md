```md
1164. Product Price at a Given Date  
Table: Products

+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| product_id    | int     |
| new_price     | int     |
| change_date   | date    |
+---------------+---------+
(product_id, change_date) is the primary key (combination of columns with unique values) of this table.
Each row of this table indicates that the price of some product was changed to a new price at some date.
Initially, all products have price 10.

Write a solution to find the prices of all products on the date 2019-08-16.

Return the result table in any order.

The result format is in the following example.

 

Example 1:

Input: 
Products table:
+------------+-----------+-------------+
| product_id | new_price | change_date |
+------------+-----------+-------------+
| 1          | 20        | 2019-08-14  |
| 2          | 50        | 2019-08-14  |
| 1          | 30        | 2019-08-15  |
| 1          | 35        | 2019-08-16  |
| 2          | 65        | 2019-08-17  |
| 3          | 20        | 2019-08-18  |
+------------+-----------+-------------+
Output: 
+------------+-------+
| product_id | price |
+------------+-------+
| 2          | 50    |
| 1          | 35    |
| 3          | 10    |
+------------+-------+
```

```py
import pandas as pd

def price_at_given_date(products: pd.DataFrame) -> pd.DataFrame: 
    # If it has date on or before 2019-08-16, the price is new price   
    selected_Date = pd.to_datetime('2019-08-16') 
    products['change_date'] = pd.to_datetime(products['change_date'])  
    has_new_price = products.loc[products['change_date'] <= selected_Date] 
    has_new_price = has_new_price.sort_values(['product_id', 'change_date'], ascending=[True, False]) 
    has_new_price['row_num'] = has_new_price.groupby('product_id').cumcount() + 1 
    has_new_price = has_new_price.loc[has_new_price['row_num'] == 1] 
    has_new_price = has_new_price[['product_id', 'new_price']] 
    has_new_price = has_new_price.rename(columns={'new_price': 'price'}) 
    # If it only has date after 2019-08-16, the price is initial price 
    initial_price_value = 10  
    has_initial_price = products.merge(has_new_price, how='left', on='product_id', indicator=True) 
    has_initial_price = has_initial_price.loc[has_initial_price['_merge'] == 'left_only'] 
    has_initial_price = has_initial_price[['product_id']] 
    has_initial_price['price'] = initial_price_value 
    # output 
    output = pd.concat([has_new_price, has_initial_price]) 
    output = output.drop_duplicates(subset=['product_id', 'price'])       
    return output   
``` 
